<MAPPING NAME="m_Simple_Test" DESCRIPTION="Simple test mapping" VERSIONNUMBER="1.0">
    <SOURCE NAME="SRC_SALES" DATABASETYPE="Oracle">
        <SOURCEFIELD NAME="SALE_ID" DATATYPE="number" PRECISION="10" SCALE="0"/>
        <SOURCEFIELD NAME="PRODUCT_NAME" DATATYPE="varchar2" PRECISION="100"/>
        <SOURCEFIELD NAME="AMOUNT" DATATYPE="number" PRECISION="10" SCALE="2"/>
        <SOURCEFIELD NAME="SALE_DATE" DATATYPE="date"/>
    </SOURCE>
    
    <TRANSFORMATION NAME="EXP_CALCULATE_TAX" TYPE="Expression" DESCRIPTION="Calculate tax amount">
        <TRANSFORMFIELD NAME="SALE_ID" DATATYPE="number" PRECISION="10"/>
        <TRANSFORMFIELD NAME="PRODUCT_NAME" DATATYPE="varchar2" PRECISION="100"/>
        <TRANSFORMFIELD NAME="AMOUNT" DATATYPE="number" PRECISION="10"/>
        <TRANSFORMFIELD NAME="TAX_AMOUNT" DATATYPE="number" PRECISION="10" EXPRESSION="AMOUNT * 0.08"/>
        <TRANSFORMFIELD NAME="TOTAL_WITH_TAX" DATATYPE="number" PRECISION="10" EXPRESSION="AMOUNT + (AMOUNT * 0.08)"/>
    </TRANSFORMATION>
    
    <TRANSFORMATION NAME="FIL_LARGE_SALES" TYPE="Filter" DESCRIPTION="Filter sales over $500">
        <FILTERCONDITION>AMOUNT > 500</FILTERCONDITION>
    </TRANSFORMATION>
    
    <TARGET NAME="TGT_LARGE_SALES" DATABASETYPE="BigQuery">
        <TARGETFIELD NAME="SALE_ID" DATATYPE="INT64" NULLABLE="false"/>
        <TARGETFIELD NAME="PRODUCT_NAME" DATATYPE="STRING" NULLABLE="false"/>
        <TARGETFIELD NAME="TAX_AMOUNT" DATATYPE="FLOAT64" NULLABLE="true"/>
        <TARGETFIELD NAME="TOTAL_WITH_TAX" DATATYPE="FLOAT64" NULLABLE="true"/>
    </TARGET>
</MAPPING>
